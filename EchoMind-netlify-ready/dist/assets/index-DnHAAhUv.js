const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-Lz6gYgZ_.js","assets/mui-CFDhWL5c.js","assets/vendor-zWPymlFl.js","assets/MainLayout-B2T8W_MF.js","assets/supabase-DTcxSDRM.js","assets/Login-9f5a5voh.js","assets/authService-DJzAVVpJ.js","assets/Signup-CjwY6ZpL.js","assets/Journal-BHh7jGkA.js","assets/Chat-QUk2HXLM.js","assets/chatService-RISS4X7f.js","assets/ChatHistory-BVi8tZIQ.js","assets/Resources-BeN6dzdh.js","assets/Prompts-Th7UicVI.js","assets/Settings-BL0vxnmz.js","assets/NotFound-ClzQbW95.js"])))=>i.map(i=>d[i]);
import{c as F,r as D,j as e,T as M,C as N,B as v,a as j,b as E,A as U}from"./mui-CFDhWL5c.js";import{f as B,a as o,B as W,h as V,i as d}from"./vendor-zWPymlFl.js";import{c as H,_ as f}from"./supabase-DTcxSDRM.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))p(a);new MutationObserver(a=>{for(const c of a)if(c.type==="childList")for(const g of c.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&p(g)}).observe(document,{childList:!0,subtree:!0});function l(a){const c={};return a.integrity&&(c.integrity=a.integrity),a.referrerPolicy&&(c.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?c.credentials="include":a.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function p(a){if(a.ep)return;a.ep=!0;const c=l(a);fetch(a.href,c)}})();var S={},R;function q(){if(R)return S;R=1;var i=B();return S.createRoot=i.createRoot,S.hydrateRoot=i.hydrateRoot,S}var K=q();const G={light:"#7a9fd3",main:"#4A6FA5",dark:"#2a4875",contrastText:"#ffffff"},X={light:"#7ad3d3",main:"#47B8B8",dark:"#2a8787",contrastText:"#ffffff"},J=(i="light")=>{const r=i==="dark";let p=F({palette:{mode:i,primary:G,secondary:X,info:{main:"#2196F3"},success:{main:"#4CAF50"},warning:{main:"#FFC107"},error:{main:"#F44336"},background:{default:r?"#121212":"#F8F9FA",paper:r?"#1E1E1E":"#FFFFFF"},text:{primary:r?"#E0E0E0":"#333333",secondary:r?"#AAAAAA":"#757575"},divider:r?"#424242":"#E0E0E0"},typography:{fontFamily:'"Open Sans", "Helvetica", "Arial", sans-serif',fontWeightLight:300,fontWeightRegular:400,fontWeightMedium:600,fontWeightBold:700,h1:{fontSize:"2.5rem",fontWeight:600,lineHeight:1.2},h2:{fontSize:"2rem",fontWeight:600,lineHeight:1.3},h3:{fontSize:"1.75rem",fontWeight:600,lineHeight:1.4},h4:{fontSize:"1.5rem",fontWeight:600,lineHeight:1.4},h5:{fontSize:"1.25rem",fontWeight:600,lineHeight:1.4},h6:{fontSize:"1rem",fontWeight:600,lineHeight:1.4},subtitle1:{fontSize:"1rem",fontWeight:500},subtitle2:{fontSize:"0.875rem",fontWeight:500},body1:{fontSize:"1rem",lineHeight:1.6},body2:{fontSize:"0.875rem",lineHeight:1.6},button:{textTransform:"none",fontWeight:600}},shape:{borderRadius:8},shadows:["none","0px 2px 1px -1px rgba(0,0,0,0.05), 0px 1px 1px 0px rgba(0,0,0,0.03), 0px 1px 3px 0px rgba(0,0,0,0.05)","0px 3px 3px -2px rgba(0,0,0,0.06), 0px 2px 6px 0px rgba(0,0,0,0.04), 0px 1px 8px 0px rgba(0,0,0,0.06)","0px 3px 4px -2px rgba(0,0,0,0.07), 0px 3px 8px 0px rgba(0,0,0,0.05), 0px 1px 12px 0px rgba(0,0,0,0.07)","0px 4px 5px -2px rgba(0,0,0,0.08), 0px 4px 10px 0px rgba(0,0,0,0.06), 0px 1px 14px 0px rgba(0,0,0,0.08)","0px 5px 6px -3px rgba(0,0,0,0.09), 0px 5px 12px 0px rgba(0,0,0,0.07), 0px 1px 18px 0px rgba(0,0,0,0.09)","0px 6px 7px -4px rgba(0,0,0,0.1), 0px 6px 14px 0px rgba(0,0,0,0.08), 0px 1px 20px 0px rgba(0,0,0,0.1)","0px 7px 8px -4px rgba(0,0,0,0.11), 0px 7px 16px 0px rgba(0,0,0,0.09), 0px 2px 22px 0px rgba(0,0,0,0.11)","0px 8px 9px -5px rgba(0,0,0,0.12), 0px 8px 18px 0px rgba(0,0,0,0.1), 0px 3px 24px 0px rgba(0,0,0,0.12)","0px 9px 10px -6px rgba(0,0,0,0.13), 0px 9px 20px 0px rgba(0,0,0,0.11), 0px 4px 26px 0px rgba(0,0,0,0.13)","0px 10px 11px -6px rgba(0,0,0,0.14), 0px 10px 22px 0px rgba(0,0,0,0.12), 0px 5px 28px 0px rgba(0,0,0,0.14)","0px 11px 12px -7px rgba(0,0,0,0.15), 0px 11px 24px 0px rgba(0,0,0,0.13), 0px 6px 30px 0px rgba(0,0,0,0.15)","0px 12px 13px -8px rgba(0,0,0,0.16), 0px 12px 26px 0px rgba(0,0,0,0.14), 0px 7px 32px 0px rgba(0,0,0,0.16)","0px 13px 14px -8px rgba(0,0,0,0.17), 0px 13px 28px 0px rgba(0,0,0,0.15), 0px 8px 34px 0px rgba(0,0,0,0.17)","0px 14px 15px -9px rgba(0,0,0,0.18), 0px 14px 30px 0px rgba(0,0,0,0.16), 0px 9px 36px 0px rgba(0,0,0,0.18)","0px 15px 16px -10px rgba(0,0,0,0.19), 0px 15px 32px 0px rgba(0,0,0,0.17), 0px 10px 38px 0px rgba(0,0,0,0.19)","0px 16px 17px -10px rgba(0,0,0,0.2), 0px 16px 34px 0px rgba(0,0,0,0.18), 0px 11px 40px 0px rgba(0,0,0,0.2)","0px 17px 18px -11px rgba(0,0,0,0.21), 0px 17px 36px 0px rgba(0,0,0,0.19), 0px 12px 42px 0px rgba(0,0,0,0.21)","0px 18px 19px -12px rgba(0,0,0,0.22), 0px 18px 38px 0px rgba(0,0,0,0.2), 0px 13px 44px 0px rgba(0,0,0,0.22)","0px 19px 20px -12px rgba(0,0,0,0.23), 0px 19px 40px 0px rgba(0,0,0,0.21), 0px 14px 46px 0px rgba(0,0,0,0.23)","0px 20px 21px -13px rgba(0,0,0,0.24), 0px 20px 42px 0px rgba(0,0,0,0.22), 0px 15px 48px 0px rgba(0,0,0,0.24)","0px 21px 22px -14px rgba(0,0,0,0.25), 0px 21px 44px 0px rgba(0,0,0,0.23), 0px 16px 50px 0px rgba(0,0,0,0.25)","0px 22px 23px -14px rgba(0,0,0,0.26), 0px 22px 46px 0px rgba(0,0,0,0.24), 0px 17px 52px 0px rgba(0,0,0,0.26)","0px 23px 24px -15px rgba(0,0,0,0.27), 0px 23px 48px 0px rgba(0,0,0,0.25), 0px 18px 54px 0px rgba(0,0,0,0.27)","0px 24px 25px -16px rgba(0,0,0,0.28), 0px 24px 50px 0px rgba(0,0,0,0.26), 0px 19px 56px 0px rgba(0,0,0,0.28)"],components:{MuiCssBaseline:{styleOverrides:{html:{scrollBehavior:"smooth"},"*, *::before, *::after":{margin:0,padding:0},"a, a:link, a:visited":{textDecoration:"none !important"},body:{backgroundColor:r?"#121212":"#F8F9FA",color:r?"#E0E0E0":"#333333"}}},MuiButton:{styleOverrides:{root:{borderRadius:8,padding:"8px 16px",boxShadow:"none","&:hover":{boxShadow:r?"none":"0px 2px 4px rgba(0, 0, 0, 0.1)"}},contained:{"&:hover":{boxShadow:r?"none":"0px 2px 4px rgba(0, 0, 0, 0.2)"}}}},MuiCard:{styleOverrides:{root:{borderRadius:12,boxShadow:r?"0px 2px 8px rgba(0, 0, 0, 0.2)":"0px 2px 8px rgba(0, 0, 0, 0.05)"}}},MuiPaper:{styleOverrides:{rounded:{borderRadius:12}}},MuiTextField:{styleOverrides:{root:{"& .MuiOutlinedInput-root":{borderRadius:8}}}},MuiChip:{styleOverrides:{root:{borderRadius:16}}},MuiAvatar:{styleOverrides:{root:{boxShadow:r?"none":"0px 2px 4px rgba(0, 0, 0, 0.1)"}}},MuiAppBar:{defaultProps:{color:"transparent"},styleOverrides:{root:{boxShadow:"none"}}}}});return p=D(p),p},O=o.createContext(void 0),Q=({children:i})=>{const r=window.matchMedia("(prefers-color-scheme: dark)").matches,l=localStorage.getItem("darkMode"),p=l!==null?l==="true":r,[a,c]=o.useState(p),g=J(a?"dark":"light"),b=()=>{c(h=>!h)};return o.useEffect(()=>{localStorage.setItem("darkMode",String(a));const h=document.querySelector('meta[name="theme-color"]');h&&h.setAttribute("content",a?g.palette.background.default:"#ffffff"),a?document.body.classList.add("dark-mode"):document.body.classList.remove("dark-mode")},[a,g]),o.useEffect(()=>{const h=window.matchMedia("(prefers-color-scheme: dark)"),y=_=>{localStorage.getItem("darkMode")===null&&c(_.matches)};return h.addEventListener("change",y),()=>{h.removeEventListener("change",y)}},[]),e.jsx(O.Provider,{value:{darkMode:a,toggleDarkMode:b},children:e.jsxs(M,{theme:g,children:[e.jsx(N,{}),i]})})},fe=()=>{const i=o.useContext(O);if(i===void 0)throw new Error("useTheme must be used within a ThemeProvider");return i},k=o.createContext(void 0),Y=i=>{var l;const r=(l=document.querySelector('meta[name="csrf-token"]'))==null?void 0:l.getAttribute("content");return r?{...i,"X-CSRF-Token":r}:i},$=({children:i})=>{const[r,l]=o.useState(null),[p,a]=o.useState(!1),[c,g]=o.useState(null),[b,h]=o.useState(null),[y,_]=o.useState(!0);return o.useEffect(()=>{(async()=>{try{_(!0);const t=window.ENV,x=(t==null?void 0:t.VITE_SUPABASE_URL)||"",s=(t==null?void 0:t.VITE_SUPABASE_ANON_KEY)||"";if(!x||!s)throw new Error("Supabase URL or Anon Key is missing from environment variables");const n=H(x,s,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0},global:{headers:Y({"X-Client-Info":"EchoMind/1.0.0"})}}),{data:u,error:m}=await n.auth.getSession();m?console.warn("Error getting session:",m.message):g(u.session);const{data:{subscription:L}}=n.auth.onAuthStateChange((ue,z)=>{g(z)});return l(n),a(!0),()=>{L.unsubscribe()}}catch(t){console.error("Error initializing Supabase:",t),h(t instanceof Error?t:new Error("Failed to initialize Supabase"))}finally{_(!1)}})()},[]),y?e.jsxs(v,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",gap:2},children:[e.jsx(j,{size:60}),e.jsx(E,{variant:"h6",children:"Connecting to EchoMind..."})]}):b?e.jsxs(v,{sx:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100vh",p:3},children:[e.jsxs(U,{severity:"error",sx:{mb:2,width:"100%",maxWidth:500},children:[e.jsx(E,{variant:"h6",children:"Connection Error"}),e.jsx(E,{variant:"body1",children:b.message})]}),e.jsx(E,{variant:"body2",children:"Please check your internet connection and try again."})]}):!p||!r?e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(j,{})}):e.jsx(k.Provider,{value:{supabase:r,isInitialized:p,session:c,error:b},children:i})},Z=()=>{const i=o.useContext(k);if(i===void 0)throw new Error("useSupabase must be used within a SupabaseProvider");return i},ee=o.createContext(void 0),re=({children:i})=>{const{supabase:r}=Z(),[l,p]=o.useState(null),[a,c]=o.useState(!0);o.useEffect(()=>{(async()=>{try{c(!0);const{data:{session:s}}=await r.auth.getSession();if(s!=null&&s.user){const{data:n,error:u}=await r.from("users").select("*").eq("id",s.user.id).single();u?(console.error("Error fetching user profile:",u),p(null)):p({id:n.id,email:n.email,displayName:n.display_name,photoURL:n.photo_url,userGeminiApiKey:n.user_gemini_api_key,preferences:n.preferences||{emailNotifications:!0,pushNotifications:!0}})}else p(null)}catch(s){console.error("Error checking session:",s),p(null)}finally{c(!1)}})();const{data:{subscription:x}}=r.auth.onAuthStateChange(async(s,n)=>{if(s==="SIGNED_IN"&&(n!=null&&n.user)){const{data:u,error:m}=await r.from("users").select("*").eq("id",n.user.id).single();m?(console.error("Error fetching user profile:",m),p(null)):p({id:u.id,email:u.email,displayName:u.display_name,photoURL:u.photo_url,userGeminiApiKey:u.user_gemini_api_key,preferences:u.preferences||{emailNotifications:!0,pushNotifications:!0}})}else s==="SIGNED_OUT"&&p(null)});return()=>{x.unsubscribe()}},[r]);const A={user:l,loading:a,signIn:async(t,x)=>{try{const{error:s}=await r.auth.signInWithPassword({email:t,password:x});if(s)throw s}catch(s){throw console.error("Error signing in:",s),s}},signUp:async(t,x,s)=>{try{const{data:n,error:u}=await r.auth.signUp({email:t,password:x,options:{data:{display_name:s}}});if(u)throw u;if(n.user){const{error:m}=await r.from("users").insert({id:n.user.id,email:n.user.email,display_name:s,created_at:new Date().toISOString()});if(m)throw m}}catch(n){throw console.error("Error signing up:",n),n}},signOut:async()=>{try{const{error:t}=await r.auth.signOut();if(t)throw t}catch(t){throw console.error("Error signing out:",t),t}},resetPassword:async t=>{try{const{error:x}=await r.auth.resetPasswordForEmail(t);if(x)throw x}catch(x){throw console.error("Error resetting password:",x),x}},updateUserProfile:async t=>{try{if(!l)throw new Error("No user logged in");if(t.displayName){const{error:s}=await r.auth.updateUser({data:{display_name:t.displayName}});if(s)throw s}const{error:x}=await r.from("users").update({display_name:t.displayName,photo_url:t.photoURL,user_gemini_api_key:t.userGeminiApiKey,preferences:t.preferences,updated_at:new Date().toISOString()}).eq("id",l.id);if(x)throw x;p(s=>s?{...s,...t}:null)}catch(x){throw console.error("Error updating profile:",x),x}}};return e.jsx(ee.Provider,{value:A,children:i})},I=o.lazy(()=>f(()=>import("./Home-Lz6gYgZ_.js"),__vite__mapDeps([0,1,2,3,4]))),te=o.lazy(()=>f(()=>import("./Login-9f5a5voh.js"),__vite__mapDeps([5,1,2,3,6,4]))),oe=o.lazy(()=>f(()=>import("./Signup-CjwY6ZpL.js"),__vite__mapDeps([7,1,2,3,6,4]))),se=o.lazy(()=>f(()=>import("./Journal-BHh7jGkA.js"),__vite__mapDeps([8,1,2,3,4]))),C=o.lazy(()=>f(()=>import("./Chat-QUk2HXLM.js"),__vite__mapDeps([9,1,2,3,10,4]))),ae=o.lazy(()=>f(()=>import("./ChatHistory-BVi8tZIQ.js"),__vite__mapDeps([11,1,2,3,10,4]))),ne=o.lazy(()=>f(()=>import("./Resources-BeN6dzdh.js"),__vite__mapDeps([12,1,2,3,4]))),ie=o.lazy(()=>f(()=>import("./Prompts-Th7UicVI.js"),__vite__mapDeps([13,1,2,3,4]))),P=o.lazy(()=>f(()=>import("./Settings-BL0vxnmz.js"),__vite__mapDeps([14,1,2,3,4]))),pe=o.lazy(()=>f(()=>import("./NotFound-ClzQbW95.js"),__vite__mapDeps([15,1,2,3,4]))),xe=()=>e.jsx(v,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(j,{size:60})});function ce(){return e.jsx($,{children:e.jsx(Q,{children:e.jsx(re,{children:e.jsx(W,{children:e.jsx(o.Suspense,{fallback:e.jsx(xe,{}),children:e.jsxs(V,{children:[e.jsx(d,{path:"/",element:e.jsx(I,{})}),e.jsx(d,{path:"/dashboard",element:e.jsx(I,{})}),e.jsx(d,{path:"/journal/*",element:e.jsx(se,{})}),e.jsx(d,{path:"/chat/history",element:e.jsx(ae,{})}),e.jsx(d,{path:"/chat/:conversationId",element:e.jsx(C,{})}),e.jsx(d,{path:"/chat",element:e.jsx(C,{})}),e.jsx(d,{path:"/resources/*",element:e.jsx(ne,{})}),e.jsx(d,{path:"/prompts/*",element:e.jsx(ie,{})}),e.jsx(d,{path:"/login",element:e.jsx(te,{})}),e.jsx(d,{path:"/signup",element:e.jsx(oe,{})}),e.jsx(d,{path:"/profile",element:e.jsx(P,{})}),e.jsx(d,{path:"/settings",element:e.jsx(P,{})}),e.jsx(d,{path:"*",element:e.jsx(pe,{})})]})})})})})})}const le=crypto.randomUUID(),w=document.createElement("meta");w.name="csrf-token";w.content=le;document.head.appendChild(w);const T=document.getElementById("root");T?K.createRoot(T).render(e.jsx(o.StrictMode,{children:e.jsx(ce,{})})):console.error("Root element not found. Cannot mount React application.");export{fe as a,Z as u};
//# sourceMappingURL=index-DnHAAhUv.js.map
