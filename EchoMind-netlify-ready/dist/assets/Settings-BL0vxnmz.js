import{u as ve,j as e,B as i,b as s,A as Z,G as d,af as p,ag as y,ah as Pe,ai as f,aj as g,P as v,i as x,g as h,a as q,ak as we,D as N,I as H,n as Q,V as X,o as ee,al as Ce,F as P,am as w,an as be,ao as Se,ap as te,v as Ie,w as Ae,x as De,y as ke,a1 as ae,z as Ee}from"./mui-CFDhWL5c.js";import{a as r}from"./vendor-zWPymlFl.js";import{u as Te,a as Ne}from"./index-DnHAAhUv.js";import{M as Me}from"./MainLayout-B2T8W_MF.js";import"./supabase-DTcxSDRM.js";const We=()=>{const{supabase:re,session:a}=Te(),{darkMode:se,toggleDarkMode:ne}=Ne();ve();const[c,o]=r.useState(!1),[M,l]=r.useState(null),[K,n]=r.useState(null),[I,U]=r.useState(""),[F,oe]=r.useState(""),[G,B]=r.useState(""),[m,W]=r.useState(""),[u,O]=r.useState(""),[A,le]=r.useState(!1),[C,ie]=r.useState(!1),[ce,R]=r.useState(!0),[de,z]=r.useState(!0),[J,L]=r.useState(""),[V,_]=r.useState(""),[D,$]=r.useState(!1),[k,Y]=r.useState(!1),[ue,b]=r.useState(!1),[j,xe]=r.useState("");r.useEffect(()=>{(async()=>{var S;if(a!=null&&a.user)try{o(!0),U(((S=a.user.email)==null?void 0:S.split("@")[0])||""),oe(a.user.email||""),R(!0),z(!0),L(""),_(""),$(!1),Y(!1)}catch(E){console.error("Error loading user settings:",E),n("Failed to load user settings. Please try again.")}finally{o(!1)}})()},[a,re]);const he=async()=>{if(a!=null&&a.user)try{o(!0),n(null),l("Profile updated successfully"),setTimeout(()=>l(null),3e3)}catch(t){console.error("Error updating profile:",t),n("Failed to update profile. Please try again.")}finally{o(!1)}},me=async()=>{if(a!=null&&a.user){if(m!==u){n("New passwords do not match");return}if(m.length<6){n("New password must be at least 6 characters long");return}try{o(!0),n(null),B(""),W(""),O(""),l("Password updated successfully"),setTimeout(()=>l(null),3e3)}catch(t){console.error("Error changing password:",t),n("Failed to change password. Please try again.")}finally{o(!1)}}},je=async()=>{if(a!=null&&a.user)try{o(!0),n(null),l("Notification settings updated successfully"),setTimeout(()=>l(null),3e3)}catch(t){console.error("Error updating notification settings:",t),n("Failed to update notification settings. Please try again.")}finally{o(!1)}},pe=async()=>{if(a!=null&&a.user)try{o(!0),n(null),l("API key settings updated successfully"),setTimeout(()=>l(null),3e3)}catch(t){console.error("Error updating API key settings:",t),n("Failed to update API key settings. Please try again.")}finally{o(!1)}},ye=async()=>{if(a!=null&&a.user){if(j!=="delete my account"){n('Please type "delete my account" to confirm');return}try{o(!0),n(null),b(!1),l("Account deleted successfully"),setTimeout(()=>{window.location.href="/"},2e3)}catch(t){console.error("Error deleting account:",t),n("Failed to delete account. Please try again.")}finally{o(!1)}}},fe=async()=>{if(a!=null&&a.user)try{o(!0);const S=JSON.stringify({profile:{name:I,email:F},journals:[{id:"1",title:"Sample Journal",content:"Sample content",created_at:new Date}],chats:[{id:"1",message:"Sample message",created_at:new Date}]},null,2),E="data:application/json;charset=utf-8,"+encodeURIComponent(S),ge=`echomind-data-${new Date().toISOString().split("T")[0]}.json`,T=document.createElement("a");T.setAttribute("href",E),T.setAttribute("download",ge),T.click(),l("Data exported successfully"),setTimeout(()=>l(null),3e3)}catch(t){console.error("Error exporting data:",t),n("Failed to export data. Please try again.")}finally{o(!1)}};return e.jsx(Me,{children:e.jsxs(i,{children:[e.jsx(s,{variant:"h4",component:"h1",gutterBottom:!0,children:"Settings"}),e.jsx(s,{variant:"body1",color:"text.secondary",paragraph:!0,children:"Manage your account settings and preferences."}),K&&e.jsx(Z,{severity:"error",sx:{mb:3},children:K}),M&&e.jsx(Z,{severity:"success",sx:{mb:3},children:M}),e.jsxs(d,{container:!0,spacing:3,children:[e.jsx(d,{item:!0,xs:12,children:e.jsxs(p,{defaultExpanded:!0,children:[e.jsx(y,{expandIcon:e.jsx(f,{}),children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Pe,{sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Account Settings"})]})}),e.jsx(g,{children:e.jsxs(v,{elevation:0,sx:{p:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Profile Information"}),e.jsxs(d,{container:!0,spacing:2,children:[e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Name",value:I,onChange:t=>U(t.target.value),margin:"normal"})}),e.jsx(d,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Email",value:F,disabled:!0,margin:"normal",helperText:"Email cannot be changed"})})]}),e.jsx(i,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{variant:"contained",color:"primary",startIcon:c?e.jsx(q,{size:20}):e.jsx(we,{}),onClick:he,disabled:c||!I.trim(),children:"Save Profile"})}),e.jsx(N,{sx:{my:3}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Change Password"}),e.jsx(x,{fullWidth:!0,label:"Current Password",type:A?"text":"password",value:G,onChange:t=>B(t.target.value),margin:"normal",InputProps:{endAdornment:e.jsx(H,{position:"end",children:e.jsx(Q,{onClick:()=>le(!A),edge:"end",children:A?e.jsx(X,{}):e.jsx(ee,{})})})}}),e.jsx(x,{fullWidth:!0,label:"New Password",type:C?"text":"password",value:m,onChange:t=>W(t.target.value),margin:"normal",InputProps:{endAdornment:e.jsx(H,{position:"end",children:e.jsx(Q,{onClick:()=>ie(!C),edge:"end",children:C?e.jsx(X,{}):e.jsx(ee,{})})})}}),e.jsx(x,{fullWidth:!0,label:"Confirm New Password",type:C?"text":"password",value:u,onChange:t=>O(t.target.value),margin:"normal",error:m!==u&&u!=="",helperText:m!==u&&u!==""?"Passwords do not match":""}),e.jsx(i,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{variant:"contained",color:"primary",onClick:me,disabled:c||!G||!m||!u||m!==u,children:"Change Password"})})]})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(y,{expandIcon:e.jsx(f,{}),children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Ce,{sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Appearance"})]})}),e.jsx(g,{children:e.jsx(v,{elevation:0,sx:{p:3},children:e.jsx(P,{control:e.jsx(w,{checked:se,onChange:ne,color:"primary"}),label:"Dark Mode"})})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(y,{expandIcon:e.jsx(f,{}),children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(be,{sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Notifications"})]})}),e.jsx(g,{children:e.jsxs(v,{elevation:0,sx:{p:3},children:[e.jsx(P,{control:e.jsx(w,{checked:ce,onChange:t=>R(t.target.checked),color:"primary"}),label:"Email Notifications"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:4,mb:2},children:"Receive email notifications about important updates and reminders."}),e.jsx(P,{control:e.jsx(w,{checked:de,onChange:t=>z(t.target.checked),color:"primary"}),label:"Daily Reminders"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:4,mb:2},children:"Receive daily reminders to journal and respond to prompts."}),e.jsx(i,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{variant:"contained",color:"primary",onClick:je,disabled:c,children:"Save Notification Settings"})})]})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(y,{expandIcon:e.jsx(f,{}),children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(Se,{sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"API Settings"})]})}),e.jsx(g,{children:e.jsxs(v,{elevation:0,sx:{p:3},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Gemini API Settings"}),e.jsx(P,{control:e.jsx(w,{checked:D,onChange:t=>$(t.target.checked),color:"primary"}),label:"Use Custom Gemini API Key"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:4,mb:2},children:"Use your own Gemini API key instead of the shared one."}),D&&e.jsx(x,{fullWidth:!0,label:"Gemini API Key",value:J,onChange:t=>L(t.target.value),margin:"normal",helperText:"Enter your Gemini API key from Google AI Studio"}),e.jsx(N,{sx:{my:3}}),e.jsx(s,{variant:"h6",gutterBottom:!0,children:"Mistral API Settings"}),e.jsx(P,{control:e.jsx(w,{checked:k,onChange:t=>Y(t.target.checked),color:"primary"}),label:"Use Custom Mistral API Key"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{ml:4,mb:2},children:"Use your own Mistral API key instead of the shared one."}),k&&e.jsx(x,{fullWidth:!0,label:"Mistral API Key",value:V,onChange:t=>_(t.target.value),margin:"normal",helperText:"Enter your Mistral API key from Mistral AI platform"}),e.jsx(i,{sx:{mt:2,display:"flex",justifyContent:"flex-end"},children:e.jsx(h,{variant:"contained",color:"primary",onClick:pe,disabled:c||D&&!J||k&&!V,children:"Save API Settings"})})]})})]})}),e.jsx(d,{item:!0,xs:12,children:e.jsxs(p,{children:[e.jsx(y,{expandIcon:e.jsx(f,{}),children:e.jsxs(i,{sx:{display:"flex",alignItems:"center"},children:[e.jsx(te,{sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Data Management"})]})}),e.jsx(g,{children:e.jsxs(v,{elevation:0,sx:{p:3},children:[e.jsx(h,{variant:"outlined",color:"primary",startIcon:e.jsx(te,{}),onClick:fe,disabled:c||!a,sx:{mb:3},children:"Export Your Data"}),e.jsx(s,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Download all your data in JSON format, including journal entries, chat history, and settings."}),e.jsx(N,{sx:{my:3}}),e.jsx(s,{variant:"h6",color:"error",gutterBottom:!0,children:"Danger Zone"}),e.jsx(h,{variant:"outlined",color:"error",startIcon:e.jsx(Ie,{}),onClick:()=>b(!0),disabled:c||!a,children:"Delete Account"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mt:1},children:"Permanently delete your account and all associated data. This action cannot be undone."})]})})]})})]}),e.jsxs(Ae,{open:ue,onClose:()=>b(!1),children:[e.jsx(De,{color:"error",children:"Delete Account"}),e.jsxs(ke,{children:[e.jsx(ae,{children:"This action will permanently delete your account and all associated data. This cannot be undone."}),e.jsx(ae,{sx:{mt:2},children:'To confirm, please type "delete my account" below:'}),e.jsx(x,{fullWidth:!0,value:j,onChange:t=>xe(t.target.value),margin:"normal",variant:"outlined",error:j!==""&&j!=="delete my account"})]}),e.jsxs(Ee,{children:[e.jsx(h,{onClick:()=>b(!1),children:"Cancel"}),e.jsx(h,{color:"error",onClick:ye,disabled:j!=="delete my account"||c,children:c?e.jsx(q,{size:24}):"Delete Account"})]})]})]})})};export{We as default};
//# sourceMappingURL=Settings-BL0vxnmz.js.map
